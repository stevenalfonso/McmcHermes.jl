<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>McmcHermes.jl · McmcHermes</title><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href><img src="assets/logo.png" alt="McmcHermes logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href>McmcHermes</a></span></div><form class="docs-search" action="search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>McmcHermes.jl</a><ul class="internal"><li><a class="tocitem" href="#Overview"><span>Overview</span></a></li><li><a class="tocitem" href="#Pkg-Registry"><span>Pkg Registry</span></a></li><li><a class="tocitem" href="#Example"><span>Example</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>McmcHermes.jl</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>McmcHermes.jl</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/stevenalfonso/McmcHermes.jl/blob/master/docs/src/index.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="McmcHermes.jl"><a class="docs-heading-anchor" href="#McmcHermes.jl">McmcHermes.jl</a><a id="McmcHermes.jl-1"></a><a class="docs-heading-anchor-permalink" href="#McmcHermes.jl" title="Permalink"></a></h1><p><em>A documentation for the McmcHermes package.</em></p><p>McmcHermes provides a simple but efficient way to generate <a href="https://en.wikipedia.org/wiki/Markov_chain_Monte_Carlo">Markov Chain Monte-Carlo</a> algorithms in order to sample a probability density distribution.</p><ul><li><a href="#McmcHermes.jl">McmcHermes.jl</a></li><li class="no-marker"><ul><li><a href="#Overview">Overview</a></li><li><a href="#Pkg-Registry">Pkg Registry</a></li><li><a href="#Example">Example</a></li></ul></li></ul><h2 id="Overview"><a class="docs-heading-anchor" href="#Overview">Overview</a><a id="Overview-1"></a><a class="docs-heading-anchor-permalink" href="#Overview" title="Permalink"></a></h2><p>The major functions in this module are:</p><p>run_mcmc: run multiple chains with a specific number of walkers.</p><p>get_flat_chain: get the stored chain of MCMC samples.</p><p>get_gelman_rubin: get the Gelman Rubin convergence diagnostic of the chains. </p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>This guide assumes that you already have define your likelihood, prior and the logarithm of the posterior probability as in the example below.</p></div></div><h2 id="Pkg-Registry"><a class="docs-heading-anchor" href="#Pkg-Registry">Pkg Registry</a><a id="Pkg-Registry-1"></a><a class="docs-heading-anchor-permalink" href="#Pkg-Registry" title="Permalink"></a></h2><pre><code class="language-julia hljs">using Pkg
Pkg.add(&quot;McmcHermes&quot;)</code></pre><h2 id="Example"><a class="docs-heading-anchor" href="#Example">Example</a><a id="Example-1"></a><a class="docs-heading-anchor-permalink" href="#Example" title="Permalink"></a></h2><p>First, let&#39;s generate some data:</p><pre><code class="language-julia hljs">using Distributions, Plots, LaTeXStrings, DataFrames, ProgressMeter

mu, sigma = 10, 2
l_b, u_b = 0, 20
d = Truncated(Normal(mu, sigma), l_b, u_b)
N = 1000
data = rand(d, N)

histogram(data, legend=false, size=(300,300), xlabel=&quot;data&quot;, show=true)</code></pre><p><img src="assets/data.png" alt="data"/></p><p>In order to sample the posterior probability distribution, it is necessary to define the likelihood, prior and logarithm of the posterior probability.</p><pre><code class="language-julia hljs">function log_likelihood(X::Vector, parameters::Vector)
    mu, sigma = parameters[1], parameters[2]
    y = 1 ./ (sqrt(2 * pi) .* sigma) .* exp.( -0.5 * ((X .- mu)./sigma).^2 )
    return sum(log.(y))
end

function log_prior(parameters::Vector)
    mu, sigma = parameters[1], parameters[2]
    if 5.0 &lt; mu &lt; 15.0 &amp;&amp; 0.0 &lt; sigma &lt; 4.0
        return 0.0
    end
    return -Inf
end

function log_probability(X::Vector, parameters::Vector)
    lp = log_prior(parameters)
    if !isfinite(lp)
        return -Inf
    end
    return lp + log_likelihood(X, parameters)
end</code></pre><p>Call the McmcHermes package and define the number of walkers, iterations, dimension of the parameter space and the initial guess.</p><pre><code class="language-julia hljs">using McmcHermes

mu, sigma = 10, 2
initparams = Vector{Float64}([mu, sigma])

n_iter, n_walkers = 1000, 100
n_dim, a = 2, 0.01

chain_tests = run_mcmc(log_probability, data, initparams, n_iter, n_walkers, n_dim, a=a)
println(size(chain_tests))</code></pre><p>(1000, 100, 2)</p><p>Gelman-Rubin&#39;s diagnostic can be obtained from the chains calling the get_gelman_rubin method.</p><pre><code class="language-julia hljs">println(&quot;Gelman Rubin Diagnostic: &quot;, get_gelman_rubin(chain_tests))</code></pre><p>Gelman Rubin Diagnostic: 1.0206366055763267</p><p>Finally, plot the chains.</p><pre><code class="language-julia hljs">labels = Tuple([L&quot;\mu&quot;, L&quot;\sigma&quot;])
x = 1:size(chain_tests)[1]
p = []
for ind in 1:n_dim
    push!(p, plot(x, [chain_tests[:,i,ind] for i in 1:size(chain_tests)[2]], legend=false, 
    lc=:black, lw=1, ylabel=labels[ind], alpha = 0.1, xticks=false))
end

plot(p[1], p[2], layout = (2,1))
plot!(size=(600,200), xlims = (0, size(chain_tests)[1]), show=true)</code></pre><p><img src="assets/chains.png" alt="chains"/></p><pre><code class="language-julia hljs">flat_chains = get_flat_chain(chain_tests, burn_in=100, thin=10)

flat = DataFrame(flat_chains, :auto)
colnames = [&quot;mu&quot;, &quot;sigma&quot;]
flat = rename!(flat, Symbol.(colnames))

using PairPlots, CairoMakie
pairplot(flat)</code></pre><p><img src="assets/corner.png" alt="corner"/></p><p><em>Develop by <a href="https://github.com/stevenalfonso">Steven Alfonso</a>.</em></p><ul></ul></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Wednesday 5 April 2023 03:01">Wednesday 5 April 2023</span>. Using Julia version 1.8.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
